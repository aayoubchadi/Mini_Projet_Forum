CREATE TABLE FORUM_USERS (
    id NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    full_name VARCHAR2(120) NOT NULL,
    email VARCHAR2(190) NOT NULL UNIQUE,
    password_hash VARCHAR2(128) NOT NULL,
    verified NUMBER(1) DEFAULT 0 NOT NULL,
    verification_code VARCHAR2(6),
    code_expires_at TIMESTAMP,
    preferred_language VARCHAR2(2) DEFAULT 'fr' NOT NULL,
    bio VARCHAR2(1000) DEFAULT '' NOT NULL,
    created_at TIMESTAMP DEFAULT SYSTIMESTAMP NOT NULL
);

CREATE TABLE FORUM_ARTICLES (
    id NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    author_id NUMBER NOT NULL,
    title VARCHAR2(200) NOT NULL,
    content CLOB NOT NULL,
    created_at TIMESTAMP DEFAULT SYSTIMESTAMP NOT NULL,
    CONSTRAINT fk_articles_author FOREIGN KEY (author_id) REFERENCES FORUM_USERS(id)
);

CREATE TABLE FORUM_COMMENTS (
    id NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    article_id NUMBER NOT NULL,
    author_id NUMBER NOT NULL,
    content VARCHAR2(2000) NOT NULL,
    created_at TIMESTAMP DEFAULT SYSTIMESTAMP NOT NULL,
    CONSTRAINT fk_comments_article FOREIGN KEY (article_id) REFERENCES FORUM_ARTICLES(id) ON DELETE CASCADE,
    CONSTRAINT fk_comments_author FOREIGN KEY (author_id) REFERENCES FORUM_USERS(id)
);
